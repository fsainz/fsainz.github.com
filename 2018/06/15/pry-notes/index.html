<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Fernando Sainz personal blog">

    <title>pry notes - fsainz</title>

    <link rel="canonical" href="http://www.fsainz.com/2018/06/15/pry-notes/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <link rel="stylesheet" href="../css/lightgallery.min.css" />
    <link rel="stylesheet" href="../css/lg-transitions.min.css" />
    <link rel="stylesheet" href="../css/lightgallery-custom.css" />

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button
        type="button"
        class="navbar-toggle"
        data-toggle="collapse"
        data-target="#bs-example-navbar-collapse-1"
      >
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">fsainz</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        <li>
          <a href="/">Home</a>
        </li>
        
        <li>
          <a href="/about/">About</a>
        </li>
        
        <li>
          <a href="/projects/">projects</a>
        </li>
        
        <li>
          <a href="//www.fsainz.com/bonn">Bonn</a>
        </li>
      </ul>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header">
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1 id="pry-notes">pry notes</h1>

<p class="meta">June 15th, 2018 - Bonn</p>

<h1 id="ruby-console--pry-tricks">Ruby console / pry tricks</h1>

<p><img src="/img/pry_logo.png" /></p>

<h1 id="history">History</h1>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">hist</span> <span class="p">(</span><span class="n">history</span><span class="p">)</span>
<span class="n">hist</span> <span class="o">--</span><span class="n">all</span> <span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
<span class="n">hist</span> <span class="o">-</span><span class="no">T</span> <span class="p">(</span><span class="o">--</span><span class="n">tail</span><span class="p">)</span> <span class="mi">20</span>
<span class="n">hist</span> <span class="o">-</span><span class="no">G</span> <span class="p">(</span><span class="o">--</span><span class="n">grep</span><span class="p">)</span> <span class="p">(</span><span class="no">REGEX</span><span class="p">)</span>
<span class="n">hist</span> <span class="o">-</span><span class="n">r</span> <span class="p">(</span><span class="o">--</span><span class="n">replay</span><span class="p">)</span> <span class="mi">14</span><span class="o">..</span><span class="mi">16</span>
<span class="n">hist</span> <span class="o">-</span><span class="n">n</span> <span class="p">(</span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">numbers</span><span class="p">)</span>

<span class="c1"># You could define aliases like these ones</span>
<span class="c1"># "hh", "hist -a -T30"</span>
<span class="c1"># "hn", "hist -a -T30 -n"</span>
<span class="c1"># "hg", "hist -a -G"</span>
<span class="c1"># "hr", "hist -a -r"</span>
<span class="c1">#</span>
<span class="c1"># To support CTRL + R</span>
<span class="c1"># https://github.com/pry/pry/wiki/FAQ#how-can-i-get-readline-support-ctrlr-etc-for-pry-in-osx</span>
<span class="c1">#</span>
<span class="c1"># .cat #{Pry.config.history.file}</span>
<span class="c1"># cat ~/.pry_history</span>
<span class="c1"># Pry.history.to_a</span>

<span class="c1"># You can load the previous history to avoid the --all flag and use CTRL + R and the up key</span>
<span class="c1"># Pry.load_history # same as Pry.history.load</span></code></pre></figure>

<h1 id="general-tips">General tips</h1>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Shell</span>
<span class="p">.</span><span class="nf">open</span> <span class="c1">#{Shop.first.image.path}</span>
<span class="p">.</span><span class="nf">ls</span> <span class="c1">#{output_file_path_for_upload}</span>

<span class="c1"># Name conflicts</span>
<span class="c1"># ls = 1</span>
<span class="c1"># =&gt; SyntaxError: syntax error, unexpected '='</span>
<span class="c1"># ;ls =1</span>

<span class="c1"># skip dump</span>
<span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="p">).</span><span class="nf">to_a</span><span class="p">;</span>

<span class="c1"># latest output</span>
<span class="n">_</span></code></pre></figure>

<h1 id="copy--paste">Copy &amp; Paste</h1>

<p><em>Quick Trick</em> : Make the font smaller</p>

<table>
  <tbody>
    <tr>
      <td>
        <img src="/img/long-output-1.png" />
      </td>
      <td>
        <img src="/img/long-output-2.png" />
      </td>
    </tr>
  </tbody>
</table>

<p>with pbcopy, pbpaste for mac</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">foo</span> <span class="o">=</span> <span class="s1">'123'</span>
<span class="sb">`echo </span><span class="si">#{</span><span class="n">foo</span><span class="si">}</span><span class="sb"> | pbcopy`</span>

<span class="n">foo</span> <span class="o">=</span> <span class="p">{</span><span class="ss">a: </span><span class="s2">"test</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="sb">`echo </span><span class="si">#{</span><span class="n">foo</span><span class="si">}</span><span class="sb"> | pbcopy`</span> <span class="c1"># does not work</span>
<span class="sb">`echo </span><span class="si">#{</span><span class="no">Shellwords</span><span class="p">.</span><span class="nf">escape</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span><span class="si">}</span><span class="sb"> | pbcopy`</span>
<span class="c1"># better</span>
<span class="no">IO</span><span class="p">.</span><span class="nf">popen</span><span class="p">(</span><span class="s1">'pbcopy'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="n">foo</span> <span class="p">}</span>

<span class="n">copied_foo</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="sb">`pbpaste`</span><span class="p">)</span></code></pre></figure>

<p>with the <code class="language-plaintext highlighter-rouge">pry-clipboard</code> gem</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># multiplatform</span>
<span class="no">Clipboard</span><span class="p">.</span><span class="nf">copy</span> <span class="no">Array</span><span class="p">.</span><span class="nf">methods</span>
<span class="n">foo</span> <span class="o">=</span> <span class="no">Clipboard</span><span class="p">.</span><span class="nf">paste</span>
<span class="n">copy</span><span class="o">-</span><span class="n">result</span>
<span class="n">copy</span><span class="o">-</span><span class="n">history</span>
<span class="c1"># Aliases</span>
<span class="s2">"cr"</span><span class="p">,</span> <span class="s2">"copy-result"</span>
<span class="s2">"cc"</span><span class="p">,</span> <span class="s2">"copy-history -T -2 -l"</span> <span class="c1"># copy input und output, at least in my case</span></code></pre></figure>

<h1 id="extra-gems">Extra Gems</h1>
<p>They can be useful, but some of them have not been updated in a long time, may not work with your rails version or be too unstable.</p>

<ul>
  <li><a href="https://github.com/hotchpotch/pry-clipboard">pry-clipboard</a>  Latest commit - Apr 2012</li>
  <li><a href="https://github.com/nixme/jazz_hands">jazz-hands</a> Latest commit - Nov 2013, includes <a href="https://github.com/nixme/pry-debugger">pry-debugger</a> which has been replaced with <a href="https://github.com/deivid-rodriguez/pry-byebug">pry-byebug</a>. An alternative might be <a href="https://github.com/plribeiro3000/jazz_fingers">jazz-fingers</a>. Other gems <a href="https://github.com/pry/pry-stack_explorer">pry-stack_explorer</a> or <a href="https://github.com/nixme/pry-nav">pry-nav</a> should also be replaced with pry-byebug.</li>
  <li><a href="https://github.com/pry/pry-coolline">pry-coolio</a> latest commit - Dec 2014</li>
  <li><a href="https://github.com/cldwalker/hirb">hirb</a> latest commit Mar 2015</li>
</ul>

<h1 id="output">Output</h1>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">array_sample</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="p">).</span><span class="nf">to_a</span>
<span class="n">hash_sample</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">200</span><span class="p">).</span><span class="nf">to_a</span><span class="p">.</span><span class="nf">in_groups_of</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="nf">to_h</span>
<span class="c1"># to play with more realistic examples, using the countries gem:</span>
<span class="n">array_sample</span> <span class="o">=</span> <span class="no">ISO3166</span><span class="o">::</span><span class="no">Country</span><span class="p">.</span><span class="nf">all_names_with_codes</span>
<span class="n">hash_sample</span> <span class="o">=</span> <span class="no">ISO3166</span><span class="o">::</span><span class="no">Country</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="s1">'de'</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">array_sample</span><span class="p">;</span>
<span class="nb">puts</span> <span class="c1">#foo.to_s + newline after each argument</span>
<span class="nb">p</span> <span class="c1"># puts with foo.inspect</span>
<span class="n">pp</span> <span class="c1"># pretty print - indentation</span>

<span class="n">j</span><span class="o">/</span><span class="n">jj</span> <span class="c1"># json / pretty json</span>

<span class="c1"># you can get a simpler kind of output even without changing the inspector</span>
<span class="n">array_sample</span><span class="p">.</span><span class="nf">inspect</span>

<span class="no">Pry</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">pager</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># IMPORTANT: Use Pry.xxx in your .pryrc, use _pry_.xxx in your repl session</span>
<span class="n">_pry_</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">pager</span> <span class="o">=</span> <span class="kp">false</span>

<span class="c1"># pager is Less by default, you can change it</span>
<span class="c1"># https://github.com/pry/pry/wiki/FAQ#how-do-i-use-other-pager-than-less</span>
<span class="c1">#</span>
<span class="c1"># Some Less shortcuts</span>
<span class="c1">#  h  show help</span>
<span class="c1">#  q  quit</span>
<span class="c1">#  G  end of file</span>
<span class="c1">#  g  start of file</span>
<span class="c1">#  * mac: fn left right top down</span>
<span class="c1">#  /  search forward</span>
<span class="c1">#  ?  search backwards</span>
<span class="c1">#  n  next match (forwards/backwards)</span>
<span class="c1">#  N  previous match (forwards/backwards)</span></code></pre></figure>

<h2 id="tabular-data">Tabular Data</h2>

<h4 id="poor-mans-table"><em>poor manâ€™s table</em></h4>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># First: ways of string interpolation, and what they ruby style guide says about it (https://github.com/bbatsov/ruby-style-guide)</span>
<span class="c1"># sprintf (alias: format) better than String#%</span>
<span class="c1"># sprinft saves to variable, printf prints</span>

<span class="nb">format</span><span class="p">(</span><span class="s1">'%-5d %-5d'</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">format</span><span class="p">(</span><span class="s1">'%&lt;first&gt;-5d %&lt;second&gt;-5d'</span><span class="p">,</span> <span class="ss">first: </span><span class="mi">20</span><span class="p">,</span> <span class="ss">second: </span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># =&gt; "20    10   " (5 chars in total for every part)</span>


<span class="k">def</span> <span class="nf">table_example</span>
  <span class="nb">printf</span><span class="p">(</span><span class="s2">"%-10s %-20s</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="s1">'id'</span><span class="p">,</span> <span class="s1">'text'</span><span class="p">)</span>
  <span class="no">Question</span><span class="p">.</span><span class="nf">limit</span><span class="p">(</span><span class="mi">4</span><span class="p">).</span><span class="nf">pluck</span><span class="p">(</span><span class="ss">:id</span><span class="p">,</span> <span class="ss">:text</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">attrs</span><span class="o">|</span>
    <span class="nb">printf</span><span class="p">(</span><span class="s2">"%-10s %-20s</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="o">*</span><span class="n">attrs</span><span class="p">)</span>
  <span class="k">end</span>
  <span class="kp">nil</span>
<span class="k">end</span>

<span class="c1"># =&gt;</span>
<span class="nb">id</span>         <span class="n">text</span>
<span class="mi">1</span>          <span class="no">Iste</span> <span class="n">sint</span> <span class="n">a</span> <span class="n">cumque</span> <span class="n">c</span>
<span class="mi">3</span>          <span class="no">Omnis</span> <span class="n">animi</span> <span class="n">ea</span> <span class="n">archi</span>
<span class="mi">4</span>          <span class="no">Facere</span> <span class="n">ut</span> <span class="n">nihil</span> <span class="n">nisi</span>
<span class="mi">9</span>          <span class="no">Eum</span> <span class="n">et</span> <span class="n">incidunt</span> <span class="n">veri</span></code></pre></figure>

<h4 id="with-hirb">With Hirb</h4>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">_table</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
  <span class="nb">print</span> <span class="no">Hirb</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">AutoTable</span><span class="p">.</span><span class="nf">render</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">_table</span> <span class="no">Question</span><span class="p">.</span><span class="nf">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="ss">fields: </span><span class="sx">%i(id questionnaire_id text)</span>

<span class="c1"># =&gt;</span>
<span class="o">+----+------------------+-------------------------------------+</span>
<span class="o">|</span> <span class="nb">id</span> <span class="o">|</span> <span class="n">questionnaire_id</span> <span class="o">|</span> <span class="n">text</span>                                <span class="o">|</span>
<span class="o">+----+------------------+-------------------------------------+</span>
<span class="o">|</span> <span class="mi">1</span>  <span class="o">|</span> <span class="mi">6</span>                <span class="o">|</span> <span class="no">Iste</span> <span class="n">sint</span> <span class="n">a</span> <span class="n">cumque</span> <span class="n">consectetur</span><span class="o">.</span>     <span class="o">|</span>
<span class="o">|</span> <span class="mi">2</span>  <span class="o">|</span> <span class="mi">7</span>                <span class="o">|</span> <span class="no">Omnis</span> <span class="n">animi</span> <span class="n">ea</span> <span class="n">architecto</span> <span class="n">reicie</span>    <span class="o">|</span>
<span class="o">|</span> <span class="mi">3</span>  <span class="o">|</span> <span class="mi">8</span>                <span class="o">|</span> <span class="no">Facere</span> <span class="n">ut</span> <span class="n">nihil</span> <span class="n">nisi</span> <span class="n">eaque</span> <span class="n">praes</span><span class="o">...</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">4</span>  <span class="o">|</span> <span class="mi">9</span>                <span class="o">|</span> <span class="no">Eum</span> <span class="n">et</span> <span class="n">incidunt</span> <span class="n">veritatis</span> <span class="n">ut</span><span class="o">.</span>       <span class="o">|</span>
<span class="o">|</span> <span class="mi">5</span>  <span class="o">|</span> <span class="mi">10</span>               <span class="o">|</span> <span class="no">Non</span> <span class="n">voluptatem</span> <span class="n">praesentium</span> <span class="n">sint</span> <span class="o">...</span> <span class="o">|</span>
<span class="o">+----+------------------+-------------------------------------+</span>

<span class="n">_table</span> <span class="p">[[</span><span class="s1">'foo'</span><span class="p">,</span> <span class="s1">'bar'</span><span class="p">,</span> <span class="s1">'baz'</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="n">_table</span> <span class="p">[{</span><span class="ss">foo: </span><span class="s1">'1'</span><span class="p">,</span> <span class="ss">bar: </span><span class="s1">'2'</span><span class="p">},</span> <span class="p">{</span><span class="ss">foo: </span><span class="s1">'3'</span><span class="p">,</span> <span class="ss">bar: </span><span class="s1">'4'</span><span class="p">}]</span>
<span class="n">_table</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">).</span><span class="nf">map</span> <span class="p">{</span><span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">i</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">from_now</span> <span class="p">},</span> <span class="ss">:fields</span><span class="o">=&gt;</span><span class="p">[</span><span class="ss">:to_s</span><span class="p">,</span> <span class="ss">:year</span><span class="p">,</span> <span class="ss">:month</span><span class="p">,</span> <span class="ss">:day</span><span class="p">]</span></code></pre></figure>

<h2 id="inspectors">Inspectors</h2>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">list</span><span class="o">-</span><span class="n">inspectors</span>
<span class="n">change</span><span class="o">-</span><span class="n">inspector</span> <span class="c1"># default, simple, clipped</span>
<span class="c1"># custom: awesome, hirb, special_cases....</span>

<span class="o">*</span> <span class="n">awesome_print</span>
<span class="n">ap</span> <span class="no">User</span><span class="p">.</span><span class="nf">all</span></code></pre></figure>

<h3 id="custom-inspectors">Custom Inspectors</h3>

<p>from <a href="https://github.com/pry/pry/blob/v0.10.4/lib/pry/commands/change_inspector.rb">https://github.com/pry/pry/blob/v0.10.4/lib/pry/commands/change_inspector.rb</a></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">if</span> <span class="n">inspector_map</span><span class="p">.</span><span class="nf">key?</span><span class="p">(</span><span class="n">inspector</span><span class="p">)</span>
  <span class="n">_pry_</span><span class="p">.</span><span class="nf">print</span> <span class="o">=</span> <span class="n">inspector_map</span><span class="p">[</span><span class="n">inspector</span><span class="p">][</span><span class="ss">:value</span><span class="p">]</span>
<span class="o">..</span></code></pre></figure>

<p>from <a href="https://github.com/pry/pry/blob/v0.10.4/lib/pry/inspector.rb">https://github.com/pry/pry/blob/v0.10.4/lib/pry/inspector.rb</a></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Pry::Inspector</span>
  <span class="nc">MAP</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s2">"simple"</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="ss">value: </span><span class="no">Pry</span><span class="o">::</span><span class="no">SIMPLE_PRINT</span><span class="p">,</span>
      <span class="ss">description: </span><span class="o">&lt;&lt;-</span><span class="no">DESCRIPTION</span><span class="p">.</span><span class="nf">each_line</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:lstrip</span><span class="p">)</span><span class="sh">
        A simple inspector that uses #puts and #inspect when printing an
        object. It has no pager, color, or pretty_inspect support.
</span><span class="no">      DESCRIPTION</span>
    <span class="p">},</span></code></pre></figure>

<p>from <a href="https://github.com/pry/pry/blob/v0.10.4/lib/pry.rb">https://github.com/pry/pry/blob/v0.10.4/lib/pry.rb</a></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby">  <span class="no">SIMPLE_PRINT</span> <span class="o">=</span> <span class="nb">proc</span> <span class="k">do</span> <span class="o">|</span><span class="n">output</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
    <span class="k">begin</span>
      <span class="n">output</span><span class="p">.</span><span class="nf">puts</span> <span class="n">value</span><span class="p">.</span><span class="nf">inspect</span>
    <span class="k">rescue</span> <span class="no">RescuableException</span>
      <span class="n">output</span><span class="p">.</span><span class="nf">puts</span> <span class="s2">"unknown"</span>
    <span class="k">end</span>
  <span class="k">end</span></code></pre></figure>

<p>We can extend them with our own, to add awesome_print or hirb for example (see <em>Config File</em>) or special logic:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Like default, but if the value is a User, it highlights the email and role</span>

<span class="no">Pry</span><span class="o">::</span><span class="no">Inspector</span><span class="o">::</span><span class="no">MAP</span><span class="p">[</span><span class="s1">'default_with_special_cases'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">description: </span><span class="s1">'provides extra info for some models'</span><span class="p">,</span>
  <span class="ss">value: </span><span class="nb">proc</span> <span class="k">do</span> <span class="o">|</span><span class="n">output</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">_pry_</span><span class="o">|</span>
    <span class="k">case</span> <span class="n">value</span>
    <span class="k">when</span> <span class="no">User</span>
      <span class="nb">puts</span> <span class="s2">"</span><span class="se">\e</span><span class="s2">[34m </span><span class="si">#{</span> <span class="n">value</span><span class="p">.</span><span class="nf">role</span> <span class="si">}</span><span class="s2"> </span><span class="si">#{</span> <span class="n">value</span><span class="p">.</span><span class="nf">email</span> <span class="si">}</span><span class="s2"> </span><span class="se">\e</span><span class="s2">[0m</span><span class="se">\n</span><span class="s2"> -------- </span><span class="se">\n</span><span class="s2">"</span>
    <span class="k">end</span>
    <span class="no">Pry</span><span class="o">::</span><span class="no">DEFAULT_PRINT</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">_pry_</span><span class="p">)</span>
  <span class="k">end</span>
<span class="p">}</span></code></pre></figure>

<h1 id="prompts">Prompts</h1>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">list</span><span class="o">-</span><span class="n">prompts</span>
<span class="n">change</span><span class="o">-</span><span class="n">prompt</span> <span class="c1"># simple, nav, none</span>

<span class="c1"># custom: rails_app, memory, ...</span></code></pre></figure>

<h3 id="custom-prompts">Custom Prompts</h3>
<p>Analogous to the inspectors</p>

<ul>
  <li><a href="https://github.com/pry/pry/blob/v0.10.4/lib/pry/commands/change_prompt.rb">https://github.com/pry/pry/blob/v0.10.4/lib/pry/commands/change_prompt.rb</a></li>
  <li><a href="https://github.com/pry/pry/blob/v0.10.4/lib/pry/prompt.rb">https://github.com/pry/pry/blob/v0.10.4/lib/pry/prompt.rb</a></li>
  <li><a href="https://github.com/pry/pry/blob/v0.10.4/lib/pry.rb">https://github.com/pry/pry/blob/v0.10.4/lib/pry.rb</a></li>
</ul>

<p>the default prompt has a variable to configure the project name</p>

<p><code class="language-plaintext highlighter-rouge">Pry.config.prompt_name = File.basename(Dir.pwd)</code></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">Pry</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">prompt_name</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">basename</span><span class="p">(</span><span class="no">Dir</span><span class="p">.</span><span class="nf">pwd</span><span class="p">)</span>

<span class="no">Pry</span><span class="o">::</span><span class="no">Prompt</span><span class="o">::</span><span class="no">MAP</span><span class="p">[</span><span class="s1">'rails_app'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">description: </span><span class="s1">'prompt with app name and environment'</span><span class="p">,</span>
  <span class="ss">value: </span><span class="nb">proc</span> <span class="k">do</span> <span class="o">|</span><span class="n">obj</span><span class="p">,</span> <span class="n">nest_level</span><span class="p">,</span> <span class="n">_pry_</span><span class="o">|</span>
    <span class="n">env_warning</span> <span class="o">=</span> <span class="k">case</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">env</span>
      <span class="k">when</span> <span class="s1">'production'</span> <span class="k">then</span> <span class="s2">" </span><span class="se">\e</span><span class="s2">[41mproduction</span><span class="se">\e</span><span class="s2">[0m "</span>
      <span class="k">when</span> <span class="s1">'staging'</span> <span class="k">then</span> <span class="s2">" </span><span class="se">\e</span><span class="s2">[42mstaging</span><span class="se">\e</span><span class="s2">[0m "</span>
    <span class="k">end</span>
    <span class="s2">"</span><span class="si">#{</span><span class="n">_pry_</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">prompt_name</span><span class="si">}#{</span><span class="n">env_warning</span><span class="si">}</span><span class="s2">[pry@</span><span class="si">#{</span><span class="n">obj</span><span class="si">}</span><span class="s2">]&gt; "</span>
  <span class="k">end</span>
<span class="p">}</span>

<span class="c1"># Set rails_app as default prompt</span>
<span class="no">Pry</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">prompt</span> <span class="o">=</span> <span class="no">Pry</span><span class="o">::</span><span class="no">Prompt</span><span class="o">::</span><span class="no">MAP</span><span class="p">[</span><span class="s1">'rails_app'</span><span class="p">][</span><span class="ss">:value</span><span class="p">]</span>

<span class="c1"># Other example usign pry text helpers: http://phansch.net/2017/02/12/a-better-pry-prompt-for-rails-console/</span></code></pre></figure>

<p><img src="/img/rails_prompt.png" /></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">Pry</span><span class="o">::</span><span class="no">Prompt</span><span class="o">::</span><span class="no">MAP</span><span class="p">[</span><span class="s1">'memory'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">description: </span><span class="s1">'shows PID and memory'</span><span class="p">,</span>
  <span class="ss">value: </span><span class="nb">proc</span> <span class="k">do</span> <span class="o">|</span><span class="n">obj</span><span class="p">,</span> <span class="n">nest_level</span><span class="p">,</span> <span class="n">_pry_</span><span class="o">|</span>
  <span class="n">pid</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="sb">`ps ax -o pid,rss | grep -E "^[[:space:]]*</span><span class="si">#{</span><span class="vg">$$</span><span class="si">}</span><span class="sb">"`</span><span class="p">.</span><span class="nf">strip</span><span class="p">.</span><span class="nf">split</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:to_i</span><span class="p">)</span>
  <span class="s2">"PID:</span><span class="si">#{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> MEM:</span><span class="si">#{</span><span class="n">size</span><span class="si">}</span><span class="s2">KB(</span><span class="si">#{</span><span class="n">helper</span><span class="p">.</span><span class="nf">number_to_human_size</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span><span class="si">}</span><span class="s2">) [pry@</span><span class="si">#{</span><span class="n">obj</span><span class="si">}</span><span class="s2">] &gt; "</span>
  <span class="k">end</span>
<span class="p">}</span></code></pre></figure>

<p><img src="/img/memory_prompt.png" /></p>

<h1 id="colors">Colors</h1>

<p>adapted from
<a href="http://stackoverflow.com/questions/1489183/colorized-ruby-output" target="_blank">http://stackoverflow.com/questions/1489183/colorized-ruby-output</a></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">module</span> <span class="nn">PryColorize</span>
  <span class="kp">module_function</span>

  <span class="k">def</span> <span class="nf">black</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>          <span class="s2">"</span><span class="se">\e</span><span class="s2">[30m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">red</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>            <span class="s2">"</span><span class="se">\e</span><span class="s2">[31m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">green</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>          <span class="s2">"</span><span class="se">\e</span><span class="s2">[32m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">brown</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>          <span class="s2">"</span><span class="se">\e</span><span class="s2">[33m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">blue</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>           <span class="s2">"</span><span class="se">\e</span><span class="s2">[34m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">magenta</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>        <span class="s2">"</span><span class="se">\e</span><span class="s2">[35m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">cyan</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>           <span class="s2">"</span><span class="se">\e</span><span class="s2">[36m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">gray</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>           <span class="s2">"</span><span class="se">\e</span><span class="s2">[37m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>

  <span class="k">def</span> <span class="nf">bg_black</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>       <span class="s2">"</span><span class="se">\e</span><span class="s2">[40m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_red</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>         <span class="s2">"</span><span class="se">\e</span><span class="s2">[41m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_green</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>       <span class="s2">"</span><span class="se">\e</span><span class="s2">[42m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_brown</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>       <span class="s2">"</span><span class="se">\e</span><span class="s2">[43m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_blue</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>        <span class="s2">"</span><span class="se">\e</span><span class="s2">[44m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_magenta</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>     <span class="s2">"</span><span class="se">\e</span><span class="s2">[45m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_cyan</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>        <span class="s2">"</span><span class="se">\e</span><span class="s2">[46m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_gray</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>        <span class="s2">"</span><span class="se">\e</span><span class="s2">[47m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>

  <span class="k">def</span> <span class="nf">bold</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>           <span class="s2">"</span><span class="se">\e</span><span class="s2">[1m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[22m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">italic</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>         <span class="s2">"</span><span class="se">\e</span><span class="s2">[3m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[23m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">underline</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>      <span class="s2">"</span><span class="se">\e</span><span class="s2">[4m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[24m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">blink</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>          <span class="s2">"</span><span class="se">\e</span><span class="s2">[5m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[25m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">reverse_color</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>  <span class="s2">"</span><span class="se">\e</span><span class="s2">[7m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[27m"</span> <span class="k">end</span>

  <span class="k">def</span> <span class="nf">list</span>
    <span class="nb">methods</span> <span class="o">=</span> <span class="nb">singleton_methods</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span> <span class="o">-</span> <span class="p">[</span><span class="ss">:list</span><span class="p">]</span>
    <span class="nb">methods</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">m</span><span class="o">|</span> <span class="nb">puts</span> <span class="nb">send</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">format</span><span class="p">(</span><span class="s1">'%-20s'</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p><img src="/img/colors.png" /></p>

<p>There are also some pry helpers (<a href="http://www.rubydoc.info/github/pry/pry/Pry/Helpers/Text">http://www.rubydoc.info/github/pry/pry/Pry/Helpers/Text</a>)</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">Pry</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">black</span>
<span class="no">Pry</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">red</span>
<span class="no">Pry</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">green</span>
<span class="no">Pry</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">yellow</span>
<span class="no">Pry</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">blue</span>
<span class="no">Pry</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">purple</span>
<span class="no">Pry</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">magenta</span>
<span class="no">Pry</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">cyan</span>
<span class="no">Pry</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">white</span>
<span class="o">--</span>
<span class="no">Pry</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">bold</span>
<span class="no">Pry</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">indent</span></code></pre></figure>

<p>Cool use: giving a warning to other devs while initializing:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># config/initializers/meta_request_warning.rb</span>
<span class="c1"># the meta-request gem conflicts with the activerecord-postgis-adapter</span>
<span class="c1"># doing a Shop.first.update_attributes({}) on the console leads to a SystemStackError</span>
<span class="k">if</span> <span class="k">defined?</span> <span class="no">MetaRequest</span>
  <span class="n">logger</span> <span class="o">=</span> <span class="no">Logger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">STDOUT</span><span class="p">)</span>
  <span class="n">logger</span><span class="p">.</span><span class="nf">warn</span> <span class="s2">"</span><span class="se">\e</span><span class="s2">[31mThe meta-request gem can cause a SystemStackError: stack level too deep when saving a shop record. See https://github.com/rgeo/activerecord-postgis-adapter/issues/81 </span><span class="se">\e</span><span class="s2">[0m"</span>
<span class="k">end</span></code></pre></figure>

<pre>
bundle exec rails c
<span style="color:red">The meta-request gem can cause a SystemStackError: stack level
too deep when saving a shop record.
See
  https://github.com/rgeo/activerecord-postgis-adapter/issues/81</span>
Loading development environment (Rails 4.2.6)
</pre>

<h1 id="emoji-">Emoji! ðŸ¦„</h1>

<h1 id="images">Images</h1>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">see</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
  <span class="nb">name</span> <span class="o">=</span> <span class="n">inline_base64</span><span class="p">(</span><span class="no">File</span><span class="p">.</span><span class="nf">basename</span><span class="p">(</span><span class="n">image_path</span><span class="p">))</span>
  <span class="n">image</span> <span class="o">=</span> <span class="n">inline_base64</span><span class="p">(</span><span class="no">File</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">image_path</span><span class="p">))</span>
  <span class="nb">puts</span> <span class="s2">"</span><span class="se">\e</span><span class="s2">]1337;File=name=</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">;height=400px;inline=1:</span><span class="si">#{</span><span class="n">image</span><span class="si">}</span><span class="se">\a\n</span><span class="s2">"</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">inline_base64</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
  <span class="no">Base64</span><span class="p">.</span><span class="nf">encode64</span><span class="p">(</span><span class="n">path</span><span class="p">).</span><span class="nf">gsub</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure>

<h1 id="exploringdebuggingediting">Exploring/Debugging/Editing</h1>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">binding</span><span class="p">.</span><span class="nf">pry</span>

<span class="n">whereami</span> <span class="c1"># @ -n</span>
<span class="n">show</span><span class="o">-</span><span class="n">source</span>
<span class="n">ls</span>
<span class="n">cd</span> <span class="c1"># cd..</span>
<span class="n">show</span><span class="o">-</span><span class="n">source</span> <span class="c1"># @  whereami</span>
<span class="n">show</span><span class="o">-</span><span class="n">source</span> <span class="no">Foo</span> <span class="o">-</span><span class="n">a</span> <span class="c1"># Found 2 candidates for `Foo` definition: ...</span>
<span class="n">find</span><span class="o">-</span><span class="nb">method</span> <span class="n">api_user?</span>
<span class="n">find</span><span class="o">-</span><span class="nb">method</span> <span class="n">location</span> <span class="no">Uberall</span><span class="o">::</span><span class="no">Client</span>
<span class="n">find</span><span class="o">-</span><span class="nb">method</span> <span class="o">-</span><span class="n">c</span> <span class="n">business_id</span> <span class="no">Uberall</span><span class="o">::</span><span class="no">Client</span> <span class="c1"># will grep the source code</span>

<span class="no">Foo</span><span class="p">.</span><span class="nf">_tab_autocomplete</span>
<span class="n">edit</span> <span class="o">-</span><span class="nb">p</span> <span class="no">Foo</span> <span class="c1"># $EDITOR or Pry.config.editor # reload</span></code></pre></figure>

<h3 id="exiting--escaping-the-loop">Exiting / Escaping the loop</h3>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">binding</span><span class="p">.</span><span class="nf">pry</span> <span class="k">if</span> <span class="n">x</span>
<span class="nb">binding</span><span class="p">.</span><span class="nf">pry</span> <span class="k">if</span> <span class="vg">$x</span>
<span class="nb">binding</span><span class="p">.</span><span class="nf">pry</span> <span class="k">unless</span> <span class="vi">@once</span><span class="p">;</span> <span class="vi">@once</span> <span class="o">=</span> <span class="kp">true</span>

<span class="nb">exit</span>
<span class="o">!!!</span> <span class="p">(</span><span class="nb">exit</span><span class="o">-</span><span class="n">program</span><span class="p">)</span>
<span class="n">disable</span><span class="o">-</span><span class="n">pry</span>
<span class="o">*</span> <span class="n">enable</span><span class="o">-</span><span class="n">pry</span></code></pre></figure>

<h3 id="docs">docs</h3>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># gem 'pry-doc'</span>

<span class="p">?</span> <span class="no">Array</span><span class="c1">#reduce (alias show-doc)</span>
<span class="p">?</span> <span class="no">Shop</span><span class="p">.</span><span class="nf">belongs_to</span></code></pre></figure>

<h3 id="rails-info">rails info</h3>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># gem 'pry-rails'</span>

<span class="n">show</span><span class="o">-</span><span class="n">middleware</span>
<span class="n">show</span><span class="o">-</span><span class="n">model</span>
<span class="n">show</span><span class="o">-</span><span class="n">models</span>
<span class="n">show</span><span class="o">-</span><span class="n">routes</span></code></pre></figure>

<h3 id="byebug">byebug</h3>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># gem 'pry-byebug'</span>
<span class="c1"># break, step, next, finish, continue</span>
<span class="c1"># backtrace, up, down, frame</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">A</span>
  <span class="k">def</span> <span class="nf">foo</span>
    <span class="no">B</span><span class="p">.</span><span class="nf">new</span><span class="p">.</span><span class="nf">bar</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">B</span>
  <span class="k">def</span> <span class="nf">bar</span>
    <span class="nb">binding</span><span class="p">.</span><span class="nf">pry</span>
    <span class="no">C</span><span class="p">.</span><span class="nf">new</span><span class="p">.</span><span class="nf">baz</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">C</span>
  <span class="k">def</span> <span class="nf">baz</span>
    <span class="mi">1</span><span class="o">+</span><span class="mi">1</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">A</span><span class="p">.</span><span class="nf">new</span><span class="p">.</span><span class="nf">foo</span></code></pre></figure>

<h3 id="more">more</h3>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1">#  Calling binding.pry within a method of a class inheriting from SimpleDelegator</span>
<span class="o">::</span><span class="no">Kernel</span><span class="p">.</span><span class="nf">binding</span><span class="p">.</span><span class="nf">pry</span>

<span class="c1"># looking into a gem</span>
<span class="n">bundle</span> <span class="n">show</span> <span class="n">devise</span>
<span class="n">bundle</span> <span class="nb">open</span> <span class="n">devise</span>
<span class="n">gem</span> <span class="n">pristine</span> <span class="n">devise</span> <span class="c1"># undo any edits (try edit -p also to avoid this problem)</span>
<span class="c1"># http://guides.rubygems.org/command-reference/#gem-pristine</span>

<span class="c1"># using regular ruby</span>
<span class="nb">method</span><span class="p">(</span><span class="ss">:foo</span><span class="p">).</span><span class="nf">source_location</span>
<span class="no">Movie</span><span class="p">.</span><span class="nf">instance_method</span><span class="p">(</span><span class="ss">:average_stars</span><span class="p">).</span><span class="nf">source_location</span>
<span class="no">Movie</span><span class="p">.</span><span class="nf">instance_method</span><span class="p">(</span><span class="ss">:average_stars</span><span class="p">).</span><span class="nf">super_method</span><span class="p">.</span><span class="nf">source_location</span> <span class="c1"># find where super is pointing to</span>
<span class="nb">caller</span> <span class="c1"># caller(1,4)</span></code></pre></figure>

<h1 id="notifications--sounds">notifications / sounds</h1>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># gem 'terminal-notifier'</span>

<span class="k">def</span> <span class="nf">ping_when_finished</span><span class="p">(</span><span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="n">block</span><span class="p">.</span><span class="nf">call</span> <span class="k">if</span> <span class="nb">block_given?</span>
  <span class="sb">`say fertig`</span>
  <span class="sb">`terminal-notifier -message "finished" -sound default -timeout 5`</span>
<span class="k">end</span></code></pre></figure>

<h1 id="waiting-for-iterations-to-finish">waiting for iterations to finish</h1>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># gem 'tqdm'</span>

<span class="k">module</span> <span class="nn">Enumerable</span>
  <span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
    <span class="no">Benchmark</span><span class="p">.</span><span class="nf">measure</span> <span class="k">do</span>
      <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">silence</span> <span class="k">do</span>
        <span class="nb">self</span><span class="p">.</span><span class="nf">tqdm</span><span class="p">.</span><span class="nf">each</span><span class="p">(</span><span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p><img src="/img/tqdm.gif" /></p>

<h1 id="foreman--pry--remote-debugging">Foreman + pry / Remote Debugging</h1>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">gem</span> <span class="s1">'pry-remote'</span>  <span class="c1"># latest comit August 2014</span>

<span class="nb">binding</span><span class="p">.</span><span class="nf">remote_pry</span>
<span class="c1">#=&gt; [pry-remote] Waiting for client on drb://localhost:9876  # at least in theory</span>

<span class="c1"># from other terminal</span>
<span class="n">bundle</span> <span class="nb">exec</span> <span class="n">pry</span><span class="o">-</span><span class="n">remote</span>

<span class="nb">binding</span><span class="p">.</span><span class="nf">remote_pry</span><span class="p">(</span><span class="s1">'127.0.0.1'</span><span class="p">,</span> <span class="mi">9888</span><span class="p">)</span>
<span class="n">bundle</span> <span class="nb">exec</span> <span class="n">pry</span><span class="o">-</span><span class="n">remote</span> <span class="o">-</span><span class="n">s</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="o">-</span><span class="nb">p</span> <span class="mi">9888</span> <span class="o">-</span><span class="n">w</span> <span class="c1"># -w = wait</span>

<span class="c1"># Address already in use - bind(2) for "127.0.0.1" port 9876</span>
<span class="c1"># restart or kill -9 $(lsof -ti tcp:9876)</span></code></pre></figure>

<h3 id="using-byebyebug">Using byebyebug</h3>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># config/initializers/byebug.rb</span>
<span class="k">if</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">env</span><span class="p">.</span><span class="nf">development?</span>
  <span class="nb">require</span> <span class="s1">'byebug/core'</span>
  <span class="no">Byebug</span><span class="p">.</span><span class="nf">wait_connection</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="no">Byebug</span><span class="p">.</span><span class="nf">start_server</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="no">ENV</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="s2">"BYEBUG_SERVER_PORT"</span><span class="p">,</span> <span class="mi">8989</span><span class="p">).</span><span class="nf">to_i</span>
<span class="k">end</span>

<span class="c1"># somewhere</span>
<span class="n">byebug</span>

<span class="n">bundle</span> <span class="nb">exec</span> <span class="n">byebug</span> <span class="o">-</span><span class="no">R</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">8989</span></code></pre></figure>

<ul>
  <li>With <a href="https://github.com/charliesome/better_errors">better errors</a> you could force an exception to get a little insight.</li>
  <li>With <a href="https://github.com/rails/web-console">web-console</a> you get a console after rendering the view</li>
</ul>

<h1 id="config---pryrc">Config - .pryrc</h1>

<ul>
  <li>Isolate from project / other devs
    <ul>
      <li><code class="language-plaintext highlighter-rouge">load '.pryrc_custom' if File.exist?('.pryrc_custom')</code></li>
      <li><code class="language-plaintext highlighter-rouge">pry_manual_gem_require</code></li>
    </ul>
  </li>
  <li>Cheatsheet</li>
</ul>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Method to try to load gems outside of the gemfile context</span>
<span class="c1">#   pry_manual_gem_require('my_gem')</span>
<span class="c1">#   pry_manual_gem_require('my_gem', 'other_dependency')</span>
<span class="c1">#</span>
<span class="c1"># Check the corresponding .gemspec to add more explicit dependencies if needed</span>
<span class="k">def</span> <span class="nf">pry_manual_gem_require</span><span class="p">(</span><span class="o">*</span><span class="n">gem_names</span><span class="p">)</span>
  <span class="n">gem_names</span><span class="p">.</span><span class="nf">flatten</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">gem_name</span><span class="o">|</span>
    <span class="n">path</span> <span class="o">=</span> <span class="no">Bundler</span><span class="p">.</span><span class="nf">with_clean_env</span> <span class="p">{</span> <span class="sx">%x[gem which </span><span class="si">#{</span><span class="n">gem_name</span><span class="si">}</span><span class="sx"> 2&gt;/dev/null]</span> <span class="p">}.</span><span class="nf">strip</span>
    <span class="k">next</span> <span class="k">if</span> <span class="n">path</span><span class="p">.</span><span class="nf">blank?</span>
    <span class="vg">$LOAD_PATH</span><span class="p">.</span><span class="nf">unshift</span><span class="p">(</span><span class="no">File</span><span class="p">.</span><span class="nf">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
  <span class="k">end</span>
  <span class="n">gem_names</span><span class="p">.</span><span class="nf">flatten</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">gem_name</span><span class="o">|</span> <span class="nb">require</span> <span class="n">gem_name</span> <span class="p">}</span>
  <span class="k">yield</span> <span class="k">if</span> <span class="nb">block_given?</span>
<span class="k">rescue</span> <span class="no">LoadError</span>
<span class="k">end</span>

<span class="n">pry_manual_gem_require</span><span class="p">(</span><span class="sx">%w(pry-clipboard clipboard)</span><span class="p">)</span>

<span class="c1">### COLORS #####################################################################</span>
<span class="c1"># See all colors with PryColorize.list</span>
<span class="k">module</span> <span class="nn">PryColorize</span>
  <span class="kp">module_function</span>

  <span class="k">def</span> <span class="nf">black</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>          <span class="s2">"</span><span class="se">\e</span><span class="s2">[30m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">red</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>            <span class="s2">"</span><span class="se">\e</span><span class="s2">[31m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">green</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>          <span class="s2">"</span><span class="se">\e</span><span class="s2">[32m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">brown</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>          <span class="s2">"</span><span class="se">\e</span><span class="s2">[33m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">blue</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>           <span class="s2">"</span><span class="se">\e</span><span class="s2">[34m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">magenta</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>        <span class="s2">"</span><span class="se">\e</span><span class="s2">[35m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">cyan</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>           <span class="s2">"</span><span class="se">\e</span><span class="s2">[36m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">gray</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>           <span class="s2">"</span><span class="se">\e</span><span class="s2">[37m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>

  <span class="k">def</span> <span class="nf">bg_black</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>       <span class="s2">"</span><span class="se">\e</span><span class="s2">[40m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_red</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>         <span class="s2">"</span><span class="se">\e</span><span class="s2">[41m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_green</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>       <span class="s2">"</span><span class="se">\e</span><span class="s2">[42m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_brown</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>       <span class="s2">"</span><span class="se">\e</span><span class="s2">[43m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_blue</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>        <span class="s2">"</span><span class="se">\e</span><span class="s2">[44m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_magenta</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>     <span class="s2">"</span><span class="se">\e</span><span class="s2">[45m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_cyan</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>        <span class="s2">"</span><span class="se">\e</span><span class="s2">[46m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">bg_gray</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>        <span class="s2">"</span><span class="se">\e</span><span class="s2">[47m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span> <span class="k">end</span>

  <span class="k">def</span> <span class="nf">bold</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>           <span class="s2">"</span><span class="se">\e</span><span class="s2">[1m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[22m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">italic</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>         <span class="s2">"</span><span class="se">\e</span><span class="s2">[3m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[23m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">underline</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>      <span class="s2">"</span><span class="se">\e</span><span class="s2">[4m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[24m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">blink</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>          <span class="s2">"</span><span class="se">\e</span><span class="s2">[5m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[25m"</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">reverse_color</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>  <span class="s2">"</span><span class="se">\e</span><span class="s2">[7m</span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="se">\e</span><span class="s2">[27m"</span> <span class="k">end</span>

  <span class="k">def</span> <span class="nf">list</span>
    <span class="nb">methods</span> <span class="o">=</span> <span class="nb">singleton_methods</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span> <span class="o">-</span> <span class="p">[</span><span class="ss">:list</span><span class="p">]</span>
    <span class="nb">methods</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">m</span><span class="o">|</span> <span class="nb">puts</span> <span class="nb">send</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">format</span><span class="p">(</span><span class="s1">'%-20s'</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1">### INSPECTORS #################################################################</span>
<span class="n">pry_manual_gem_require</span><span class="p">(</span><span class="s1">'awesome_print'</span><span class="p">)</span> <span class="k">do</span>
  <span class="no">Pry</span><span class="o">::</span><span class="no">Inspector</span><span class="o">::</span><span class="no">MAP</span><span class="p">[</span><span class="s1">'awesome'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="ss">value: </span><span class="nb">proc</span> <span class="p">{</span> <span class="o">|</span><span class="n">output</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span> <span class="n">output</span><span class="p">.</span><span class="nf">puts</span> <span class="n">value</span><span class="p">.</span><span class="nf">ai</span> <span class="p">},</span>
    <span class="ss">description: </span><span class="s1">'Awesome Print'</span>
  <span class="p">}</span>
<span class="k">end</span>

<span class="n">pry_manual_gem_require</span><span class="p">(</span><span class="s1">'hirb'</span><span class="p">)</span> <span class="k">do</span>
  <span class="no">Hirb</span><span class="p">.</span><span class="nf">enable</span>
  <span class="no">Pry</span><span class="o">::</span><span class="no">Inspector</span><span class="o">::</span><span class="no">MAP</span><span class="p">[</span><span class="s1">'hirb'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="ss">value: </span><span class="nb">proc</span> <span class="k">do</span> <span class="o">|*</span><span class="n">args</span><span class="o">|</span>
      <span class="no">Hirb</span><span class="o">::</span><span class="no">View</span><span class="p">.</span><span class="nf">view_or_page_output</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">||</span> <span class="no">Pry</span><span class="o">::</span><span class="no">DEFAULT_PRINT</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="k">end</span><span class="p">,</span>
    <span class="ss">description: </span><span class="s1">'Hirb (tabular data)'</span>
  <span class="p">}</span>
  <span class="c1"># _table [['foo', 'bar', 'baz'], [1,2,3], [4,5,6]]</span>
  <span class="c1"># _table [{foo: '1', bar: '2'}, {foo: '3', bar: '4'}]</span>
  <span class="c1"># _table (1..3).map {|i| i.days.from_now }, :fields=&gt;[:to_s, :year, :month, :day]</span>
  <span class="k">def</span> <span class="nf">_table</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="nb">print</span> <span class="no">Hirb</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">AutoTable</span><span class="p">.</span><span class="nf">render</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># Example custom Inspector</span>
<span class="c1"># Pry::Inspector::MAP['default_with_special_cases'] = {</span>
<span class="c1">#   description: 'provides extra info for some models',</span>
<span class="c1">#   value: proc do |output, value, pry_|</span>
<span class="c1">#     case value</span>
<span class="c1">#     when User</span>
<span class="c1">#       puts "\e[34m #{value.role.name} #{value.email} \e[0m"</span>
<span class="c1">#     end</span>
<span class="c1">#     Pry::DEFAULT_PRINT.call(output, value, pry_)</span>
<span class="c1">#   end</span>
<span class="c1"># }</span>

<span class="c1">### PROMPTS ####################################################################</span>
<span class="no">Pry</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">prompt_name</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">basename</span><span class="p">(</span><span class="no">Dir</span><span class="p">.</span><span class="nf">pwd</span><span class="p">)</span>

<span class="no">Pry</span><span class="o">::</span><span class="no">Prompt</span><span class="o">::</span><span class="no">MAP</span><span class="p">[</span><span class="s1">'rails_app'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">description: </span><span class="s1">'prompt with app name and environment'</span><span class="p">,</span>
  <span class="ss">value: </span><span class="nb">proc</span> <span class="k">do</span> <span class="o">|</span><span class="n">obj</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">pry_</span><span class="o">|</span>
    <span class="n">env_warning</span> <span class="o">=</span>
      <span class="k">case</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">env</span>
      <span class="k">when</span> <span class="s1">'production'</span> <span class="k">then</span> <span class="s2">" </span><span class="si">#{</span><span class="no">PryColorize</span><span class="p">.</span><span class="nf">bg_red</span><span class="p">(</span><span class="s1">'production'</span><span class="p">)</span><span class="si">}</span><span class="s2"> "</span>
      <span class="k">when</span> <span class="s1">'staging'</span> <span class="k">then</span> <span class="s2">" </span><span class="si">#{</span><span class="no">PryColorize</span><span class="p">.</span><span class="nf">bg_green</span><span class="p">(</span><span class="s1">'staging'</span><span class="p">)</span><span class="si">}</span><span class="s2"> "</span>
      <span class="k">end</span>
    <span class="s2">"</span><span class="si">#{</span><span class="n">pry_</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">prompt_name</span><span class="si">}#{</span><span class="n">env_warning</span><span class="si">}</span><span class="s2">[pry@</span><span class="si">#{</span><span class="n">obj</span><span class="si">}</span><span class="s2">]&gt; "</span>
  <span class="k">end</span>
<span class="p">}</span>

<span class="no">Pry</span><span class="o">::</span><span class="no">Prompt</span><span class="o">::</span><span class="no">MAP</span><span class="p">[</span><span class="s1">'memory'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">description: </span><span class="s1">'shows PID and memory'</span><span class="p">,</span>
  <span class="ss">value: </span><span class="nb">proc</span> <span class="k">do</span> <span class="o">|</span><span class="n">obj</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="o">|</span>
    <span class="n">pid</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="sb">`ps ax -o pid,rss | grep -E "^[[:space:]]*</span><span class="si">#{</span><span class="vg">$$</span><span class="si">}</span><span class="sb">"`</span><span class="p">.</span><span class="nf">strip</span><span class="p">.</span><span class="nf">split</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:to_i</span><span class="p">)</span>
    <span class="s2">"PID:</span><span class="si">#{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> MEM:</span><span class="si">#{</span><span class="n">size</span><span class="si">}</span><span class="s2">KB(</span><span class="si">#{</span><span class="n">helper</span><span class="p">.</span><span class="nf">number_to_human_size</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span><span class="si">}</span><span class="s2">) [pry@</span><span class="si">#{</span><span class="n">obj</span><span class="si">}</span><span class="s2">] &gt; "</span>
  <span class="k">end</span>
<span class="p">}</span>

<span class="c1"># Set rails_app as default prompt</span>
<span class="no">Pry</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">prompt</span> <span class="o">=</span> <span class="no">Pry</span><span class="o">::</span><span class="no">Prompt</span><span class="o">::</span><span class="no">MAP</span><span class="p">[</span><span class="s1">'rails_app'</span><span class="p">][</span><span class="ss">:value</span><span class="p">]</span>

<span class="c1">### COMMANDS AND ALIASES #######################################################</span>
<span class="no">Pry</span><span class="o">::</span><span class="no">Commands</span><span class="p">.</span><span class="nf">block_command</span> <span class="s1">'hl'</span><span class="p">,</span> <span class="s1">'Pry.history.load'</span> <span class="k">do</span>
  <span class="no">Pry</span><span class="p">.</span><span class="nf">history</span><span class="p">.</span><span class="nf">load</span>
<span class="k">end</span>

<span class="no">Pry</span><span class="p">.</span><span class="nf">commands</span><span class="p">.</span><span class="nf">alias_command</span> <span class="s1">'hh'</span><span class="p">,</span> <span class="s1">'hist -a -T20'</span>
<span class="no">Pry</span><span class="p">.</span><span class="nf">commands</span><span class="p">.</span><span class="nf">alias_command</span> <span class="s1">'hn'</span><span class="p">,</span> <span class="s1">'hist -a -T20 -n'</span>
<span class="no">Pry</span><span class="p">.</span><span class="nf">commands</span><span class="p">.</span><span class="nf">alias_command</span> <span class="s1">'hg'</span><span class="p">,</span> <span class="s1">'hist -a -G'</span>
<span class="no">Pry</span><span class="p">.</span><span class="nf">commands</span><span class="p">.</span><span class="nf">alias_command</span> <span class="s1">'hr'</span><span class="p">,</span> <span class="s1">'hist -a -r'</span>

<span class="no">Pry</span><span class="o">::</span><span class="no">Commands</span><span class="p">.</span><span class="nf">block_command</span><span class="p">(</span><span class="s1">'cheat'</span><span class="p">,</span> <span class="s1">'Display Cheatsheet'</span><span class="p">)</span> <span class="k">do</span>
  <span class="nb">puts</span> <span class="s1">'Shortcuts:'</span>
  <span class="nb">puts</span> <span class="s1">'@ : whereami'</span>
  <span class="nb">puts</span> <span class="s1">'? : show-doc'</span>
  <span class="nb">puts</span> <span class="s1">'hl : Pry.history.load         load whole history'</span>
  <span class="nb">puts</span> <span class="s1">'hh : hist -a -T20             Last 20 commands'</span>
  <span class="nb">puts</span> <span class="s1">'hn : hist -a -T20 -n          Last 20 command no numbers'</span>
  <span class="nb">puts</span> <span class="s1">'hg : hist -a -G               Commands matching expression'</span>
  <span class="nb">puts</span> <span class="s1">'hr : hist -a -r               hist -r &lt;command number&gt; to run a command'</span>
  <span class="nb">puts</span> <span class="s1">'help alias                    See all the aliases available'</span>
<span class="k">end</span>

<span class="c1">### PROJECT HISTORY FILE #######################################################</span>
<span class="no">Pry</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">history</span><span class="p">.</span><span class="nf">file</span> <span class="o">=</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s1">'.pry_history'</span><span class="p">)</span>

<span class="c1">### CUSTOM #####################################################################</span>
<span class="n">custom_config_path</span> <span class="o">=</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s1">'.pryrc_custom'</span><span class="p">)</span>
<span class="nb">load</span> <span class="n">custom_config_path</span> <span class="k">if</span> <span class="no">File</span><span class="p">.</span><span class="nf">exist?</span><span class="p">(</span><span class="n">custom_config_path</span><span class="p">)</span></code></pre></figure>

<h2 id="other">Other</h2>
<ul>
  <li>
    <p><a href="https://github.com/deivid-rodriguez/byebug">byebug</a> Rails default debugger</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">binding.irb</code> in ruby 2.4</p>
  </li>
</ul>

<hr />

<h2 id="edits">Edits:</h2>

<ul>
  <li>In my case I need the to require <code class="language-plaintext highlighter-rouge">rb-readline</code> to load the history:</li>
</ul>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># .pryrc_custom</span>

<span class="n">pry_manual_gem_require</span><span class="p">(</span><span class="s1">'rb-readline'</span><span class="p">)</span></code></pre></figure>

<ul>
  <li>In order to highlight the environment in production/staging we need to load pry, you might not want to do that and
use <code class="language-plaintext highlighter-rouge">.irbrc</code> instead:</li>
</ul>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># .irbrc</span>

<span class="k">if</span> <span class="k">defined?</span><span class="p">(</span><span class="no">Rails</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">env</span>
  <span class="n">reset</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\e</span><span class="s2">[0m"</span>
  <span class="n">color</span> <span class="o">=</span> <span class="k">case</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">env</span>
          <span class="k">when</span> <span class="s1">'production'</span> <span class="k">then</span> <span class="s2">"</span><span class="se">\e</span><span class="s2">[41m"</span> <span class="c1"># red background</span>
          <span class="k">when</span> <span class="s1">'staging'</span> <span class="k">then</span> <span class="s2">"</span><span class="se">\e</span><span class="s2">[42m"</span> <span class="c1"># green background</span>
          <span class="k">end</span>

  <span class="n">app_name_env</span> <span class="o">=</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">class</span><span class="p">.</span><span class="nf">parent_name</span><span class="p">.</span><span class="nf">underscore</span>
  <span class="n">app_name_env</span> <span class="o">&lt;&lt;</span> <span class="s2">"</span><span class="si">#{</span><span class="n">reset</span><span class="si">}</span><span class="s2">:</span><span class="si">#{</span><span class="n">color</span><span class="si">}#{</span><span class="no">Rails</span><span class="p">.</span><span class="nf">env</span><span class="si">}#{</span><span class="n">reset</span><span class="si">}</span><span class="s2">"</span>

  <span class="no">IRB</span><span class="p">.</span><span class="nf">conf</span><span class="p">[</span><span class="ss">:PROMPT</span><span class="p">][</span><span class="ss">:RAILS_ENV</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="no">PROMPT_I</span><span class="p">:</span> <span class="s2">"%N(</span><span class="si">#{</span><span class="n">app_name_env</span><span class="si">}</span><span class="s2">):%03n:%i&gt; "</span><span class="p">,</span>
    <span class="no">PROMPT_N</span><span class="p">:</span> <span class="s2">"%N(</span><span class="si">#{</span><span class="n">app_name_env</span><span class="si">}</span><span class="s2">):%03n:%i&gt; "</span><span class="p">,</span>
    <span class="no">PROMPT_S</span><span class="p">:</span> <span class="s2">"%N(</span><span class="si">#{</span><span class="n">app_name_env</span><span class="si">}</span><span class="s2">):%03n:%i%l "</span><span class="p">,</span>
    <span class="no">PROMPT_C</span><span class="p">:</span> <span class="s2">"%N(</span><span class="si">#{</span><span class="n">app_name_env</span><span class="si">}</span><span class="s2">):%03n:%i* "</span><span class="p">,</span>
    <span class="no">RETURN</span><span class="p">:</span> <span class="s2">"=&gt; %s</span><span class="se">\n</span><span class="s2">"</span>
  <span class="p">}</span>
  <span class="no">IRB</span><span class="p">.</span><span class="nf">conf</span><span class="p">[</span><span class="ss">:PROMPT_MODE</span><span class="p">]</span> <span class="o">=</span> <span class="ss">:RAILS_ENV</span>
<span class="k">end</span></code></pre></figure>



                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2017/02/17/console-tricks-talk/" data-toggle="tooltip" data-placement="top" title="console tricks and shortcuts talks">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2018/06/17/hash-cleaner/" data-toggle="tooltip" data-placement="top" title="epic hash cleaner">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/fsainz">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="http://codepen.io/fsainz">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-codepen fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="https://speakerdeck.com/fsainz/">
                          <span class="fa-stack fa-lg">
                            <svg width="50px" height="50px" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                                <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
                                    <path d="M256,512 C397.384903,512 512,397.384903 512,256 C512,114.615097 397.384903,0 256,0 C114.615097,0 0,114.615097 0,256 C0,397.384903 114.615097,512 256,512 Z M157.00292,151 C136.014487,151 119,168.007298 119,188.999 L119,323.001 C119,343.987268 136.020832,361 157.00292,361 L355.99708,361 C376.985513,361 394,343.992702 394,323.001 L394,188.999 C394,168.012732 376.979168,151 355.99708,151 L157.00292,151 Z M213.327471,218.914007 C201.732729,218.914007 192.333333,228.319857 192.333333,239.90541 L192.333333,272.040251 C192.333333,283.633483 201.743977,293.031654 213.327471,293.031654 L299.672529,293.031654 C311.267271,293.031654 320.666667,283.625804 320.666667,272.040251 L320.666667,239.90541 C320.666667,228.312179 311.256023,218.914007 299.672529,218.914007 L213.327471,218.914007 Z M210.470588,255.972831 L247.529412,237.639497 L247.529412,274.306164 L210.470588,255.972831 Z M264.279134,274.502243 L264.279134,237.443419 L300.945801,255.972831 L264.279134,274.502243 Z" id="sliderdeck" fill="#404040" sketch:type="MSShapeGroup"></path>
                                </g>
                            </svg>
                          </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="http://fsainz.tumblr.com/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-tumblr fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="https://de.linkedin.com/in/fernandosainz">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="mailto:info@fsainz.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">
                  Copyright &copy; fsainz 2026
                  <br />
                  Theme adapted from <a class='text-muted' href="https://github.com/IronSummitMedia/startbootstrap-clean-blog-jekyll">startbootstrap-clean-blog-jekyll</a>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>

<script src="../js/lightgallery-all.min.js"></script>

<script>
  
</script>


</body>

</html>
