<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Fernando Sainz personal blog">

    <title>Javascript modules - fsainz</title>

    <link rel="canonical" href="http://www.fsainz.com/2016/03/20/javascript-modules/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <link rel="stylesheet" href="../css/lightgallery.min.css" />
    <link rel="stylesheet" href="../css/lg-transitions.min.css" />
    <link rel="stylesheet" href="../css/lightgallery-custom.css" />

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button
        type="button"
        class="navbar-toggle"
        data-toggle="collapse"
        data-target="#bs-example-navbar-collapse-1"
      >
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">fsainz</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        <li>
          <a href="/">Home</a>
        </li>
        
        <li>
          <a href="/about/">About</a>
        </li>
        
        <li>
          <a href="/projects/">projects</a>
        </li>
        
        <li>
          <a href="//www.fsainz.com/bonn">Bonn</a>
        </li>
      </ul>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header">
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1 id="javascript-modules">Javascript modules</h1>

<p class="meta">March 20th, 2016 - Bonn</p>

<p>I’ve been using javascript modules of different kinds without understanding the terminology and approaches, I wanted to make some notes about it:</p>

<p>We’ve using some sort of modules before with Coffeescript/Angular in Rails projects. Often  we just had an object <code class="language-plaintext highlighter-rouge">App</code> defined on the global scope, to which we attached the given module:</p>

<figure class="highlight"><pre><code class="language-coffee" data-lang="coffee">  <span class="c1"># setup.js</span>

  <span class="nb">window</span><span class="p">.</span><span class="na">App</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="c1"># modules/myModule.js</span>

  <span class="k">class</span> <span class="nx">App</span><span class="p">.</span><span class="na">myModule</span>
    <span class="nx">foo</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="nx">privateFunction</span> <span class="o">=</span> <span class="o">-&gt;</span>
      <span class="nx">foo</span><span class="o">++</span><span class="p">;</span>
    <span class="vi">@</span><span class="na">publicFunction</span><span class="o">:</span> <span class="o">-&gt;</span>
      <span class="nx">privateFunction</span><span class="p">();</span>
      <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="nx">foo</span>

  <span class="c1"># otherfile.js</span>

  <span class="nx">App</span><span class="p">.</span><span class="na">myModule</span><span class="p">.</span><span class="na">publicFunction</span><span class="p">();</span> <span class="c1"># 2</span>
  <span class="nx">App</span><span class="p">.</span><span class="na">myModule</span><span class="p">.</span><span class="na">publicFunction</span><span class="p">();</span> <span class="c1"># 3</span></code></pre></figure>

<p>which compiles to</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">App</span> <span class="o">=</span> <span class="p">{};</span>

<span class="nx">App</span><span class="p">.</span><span class="nx">myModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">foo</span><span class="p">,</span> <span class="nx">privateFunction</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">myModule</span><span class="p">()</span> <span class="p">{}</span>

  <span class="nx">foo</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="nx">privateFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">foo</span><span class="o">++</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="nx">myModule</span><span class="p">.</span><span class="nx">publicFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">privateFunction</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="nx">myModule</span><span class="p">;</span>

<span class="p">})();</span>

<span class="nx">App</span><span class="p">.</span><span class="nx">myModule</span><span class="p">.</span><span class="nx">publicFunction</span><span class="p">();</span> <span class="c1">// 2</span>
<span class="nx">App</span><span class="p">.</span><span class="nx">myModule</span><span class="p">.</span><span class="nx">publicFunction</span><span class="p">();</span> <span class="c1">// 3</span></code></pre></figure>

<p>With the rails sprockets bundling, the different js files were compiled in the order specified in the manifest. There was not a way to control dependencies or load part of it asynchronously. The compiled coffee files were wrapped in a IIFE to provide isolation.</p>

<p>Our process has been very similar with angular</p>

<figure class="highlight"><pre><code class="language-coffee" data-lang="coffee">  <span class="c1"># setup file</span>

  <span class="nx">angular</span><span class="p">.</span><span class="na">module</span><span class="p">(</span><span class="s">'myApp'</span><span class="p">,</span> <span class="p">[</span><span class="nx">dependencies</span><span class="p">])</span>

  <span class="c1"># directive file</span>

  <span class="nx">angular</span><span class="p">.</span><span class="na">module</span> <span class="s">"app"</span>
    <span class="p">.</span><span class="na">directive</span> <span class="s">"myDirective"</span><span class="p">,</span> <span class="p">(</span><span class="nx">dependencies</span><span class="p">)</span><span class="o">-&gt;</span>
      <span class="o">//</span> <span class="p">...</span></code></pre></figure>

<p><br /></p>

<h4 id="module-patterns">Module Patterns</h4>

<p>From <a href="https://medium.freecodecamp.com/javascript-modules-a-beginner-s-guide-783f7d7a5fcc">JavaScript Modules: A Beginner’s Guide</a>: <em>The Module pattern is used to mimic the concept of classes (since JavaScript doesn’t natively support classes) so that we can store both public and private methods and variables inside a single object. That allows us to create a public facing API for the methods that we want to expose to the world, while still encapsulating private variables and methods in a closure scope.</em></p>

<p>There’s very good explanation on the <a href="https://addyosmani.com/resources/essentialjsdesignpatterns/book/#modulepatternjavascript">Learning JavaScript Design Patterns</a> from Addy Osmani</p>

<p>This is the classic pattern:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">testModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">incrementCounter</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">counter</span><span class="o">++</span><span class="p">;</span>
    <span class="p">},</span>
  <span class="p">};</span>
<span class="p">})();</span>

<span class="c1">// Increment our counter</span>
<span class="nx">testModule</span><span class="p">.</span><span class="nx">incrementCounter</span><span class="p">();</span></code></pre></figure>

<p>He goes to show a common template:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">myNamespace</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">myPrivateVar</span><span class="p">,</span> <span class="nx">myPrivateMethod</span><span class="p">;</span>

  <span class="c1">// A private counter variable</span>
  <span class="nx">myPrivateVar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="c1">// A private function which logs any arguments</span>
  <span class="nx">myPrivateMethod</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">foo</span> <span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">foo</span> <span class="p">);</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="p">{</span>

    <span class="c1">// A public variable</span>
    <span class="na">myPublicVar</span><span class="p">:</span> <span class="dl">"</span><span class="s2">foo</span><span class="dl">"</span><span class="p">,</span>

    <span class="c1">// A public function utilizing privates</span>
    <span class="na">myPublicFunction</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">bar</span> <span class="p">)</span> <span class="p">{</span>

      <span class="c1">// Increment our private counter</span>
      <span class="nx">myPrivateVar</span><span class="o">++</span><span class="p">;</span>

      <span class="c1">// Call our private method using bar</span>
      <span class="nx">myPrivateMethod</span><span class="p">(</span> <span class="nx">bar</span> <span class="p">);</span>

    <span class="p">}</span>
  <span class="p">};</span>

<span class="p">})();</span></code></pre></figure>

<h4 id="variation-import-mixins">Variation: Import mixins</h4>
<p>This shows how to pass and alias globals (e.g jQuery, Underscore) to our module:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Global module</span>
<span class="kd">var</span> <span class="nx">myModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">(</span> <span class="nx">jQ</span><span class="p">,</span> <span class="nx">_</span> <span class="p">)</span> <span class="p">{</span>

    <span class="kd">function</span> <span class="nx">privateMethod1</span><span class="p">(){</span>
        <span class="nx">jQ</span><span class="p">(</span><span class="dl">"</span><span class="s2">.container</span><span class="dl">"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="dl">"</span><span class="s2">test</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">_</span><span class="p">.</span><span class="nx">min</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span><span class="p">{</span>
        <span class="na">publicMethod</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">privateMethod1</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">};</span>

<span class="c1">// Pull in jQuery and Underscore</span>
<span class="p">})(</span> <span class="nx">jQuery</span><span class="p">,</span> <span class="nx">_</span> <span class="p">);</span>

<span class="nx">myModule</span><span class="p">.</span><span class="nx">publicMethod</span><span class="p">();</span></code></pre></figure>

<h4 id="variation-exports">Variation: Exports</h4>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Global module</span>
<span class="kd">var</span> <span class="nx">myModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

  <span class="c1">// Module object</span>
  <span class="kd">var</span> <span class="nx">module</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="nx">privateVariable</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Hello World</span><span class="dl">"</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">privateMethod</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>

  <span class="nx">module</span><span class="p">.</span><span class="nx">publicProperty</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Foobar</span><span class="dl">"</span><span class="p">;</span>
  <span class="nx">module</span><span class="p">.</span><span class="nx">publicMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">privateVariable</span> <span class="p">);</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="nx">module</span><span class="p">;</span>

<span class="p">})();</span></code></pre></figure>

<h4 id="revealing-module-pattern">Revealing Module pattern.</h4>

<p>We define all of our functions and variables in the private scope and return an anonymous object with exposes the ones meant to be public: public.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">myRevealingModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">privateVar</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Ben Cherry</span><span class="dl">"</span><span class="p">,</span>
       <span class="nx">publicVar</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Hey there!</span><span class="dl">"</span><span class="p">;</span>

    <span class="kd">function</span> <span class="nx">privateFunction</span><span class="p">()</span> <span class="p">{</span>
       <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="dl">"</span><span class="s2">Name:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">privateVar</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">publicSetName</span><span class="p">(</span> <span class="nx">strName</span> <span class="p">)</span> <span class="p">{</span>
       <span class="nx">privateVar</span> <span class="o">=</span> <span class="nx">strName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">publicGetName</span><span class="p">()</span> <span class="p">{</span>
       <span class="nx">privateFunction</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="c1">// Reveal public pointers to</span>
    <span class="c1">// private functions and properties</span>

    <span class="k">return</span> <span class="p">{</span>
       <span class="na">setName</span><span class="p">:</span> <span class="nx">publicSetName</span><span class="p">,</span>
       <span class="na">greeting</span><span class="p">:</span> <span class="nx">publicVar</span><span class="p">,</span>
       <span class="na">getName</span><span class="p">:</span> <span class="nx">publicGetName</span>
    <span class="p">};</span>

  <span class="p">})();</span></code></pre></figure>

<h2 id="globals-commonjs-amd-umd">Globals, CommonJS, AMD, UMD</h2>
<p>With the previous patterns, we rely on a global variable that sets the namespace for that given module. This is known as the <strong>Globals</strong> option.
In the last years, there’s been some approaches developed to account for dependency order and avoid namespace collisions, by implementing a convention that avoids going through the global scope.</p>

<h3 id="commonjs">CommonJS</h3>
<p>A CommonJS module looks like this:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// myModule.js</span>
  <span class="kd">function</span> <span class="nx">myModule</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="dl">'</span><span class="s1">foo!</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">myModule</span><span class="p">;</span></code></pre></figure>

<p><code class="language-plaintext highlighter-rouge">module</code> is an special object that will keep a reference to the exported content provided in <code class="language-plaintext highlighter-rouge">myModule.js</code> in a way in which it can be required be calling <code class="language-plaintext highlighter-rouge">require('myModule')</code> in another file. This works on the server, where those <em>requires</em> will load those files synchronously, this is the Node.js approach. The reference passed to <code class="language-plaintext highlighter-rouge">module.exports</code> doesn’t have to be a function:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// foo.js</span>
  <span class="kd">var</span> <span class="nx">Foo</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Hey Foo</span><span class="dl">"</span>
  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Foo</span><span class="p">;</span>

  <span class="c1">// bar.js</span>
  <span class="kd">var</span> <span class="nx">Bar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">sayHi</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hi!</span><span class="dl">"</span><span class="p">)</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Bar</span><span class="p">;</span>

  <span class="c1">// otherFile.js</span>
  <span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span>  
  <span class="kd">var</span> <span class="nx">bar</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">bar</span><span class="dl">'</span><span class="p">)</span> <span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span>
  <span class="nx">bar</span><span class="p">.</span><span class="nx">sayHi</span><span class="p">();</span></code></pre></figure>

<h3 id="amd--asynchronous-module-definition">AMD = Asynchronous Module Definition</h3>
<p>This is the asynchronous variant for the browser. A couple of examples:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// myModule.js</span>
  <span class="c1">// the empty array correspond to the dependencies (none)</span>
  <span class="nx">define</span><span class="p">([],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">hello</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">});</span>

  <span class="c1">//myOtherModule.js</span>
  <span class="c1">// the empty array correspond to the dependencies (none)</span>
  <span class="nx">define</span><span class="p">([],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">goodbye</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">goodbye</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">});</span>

  <span class="c1">// otherFile.js</span>
  <span class="c1">// here we have `myModule`, `myOtherModule` as dependencies</span>
  <span class="nx">define</span><span class="p">([</span><span class="dl">'</span><span class="s1">myModule</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">myOtherModule</span><span class="dl">'</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">myModule</span><span class="p">,</span> <span class="nx">myOtherModule</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myModule</span><span class="p">.</span><span class="nx">hello</span><span class="p">());</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myOtherModule</span><span class="p">.</span><span class="nx">goodbye</span><span class="p">());</span>
  <span class="p">});</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// calculator.js</span>
<span class="nx">define</span><span class="p">(</span><span class="dl">"</span><span class="s2">calculator</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">sum</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">};</span>
<span class="p">});</span>

<span class="c1">// app.js</span>
<span class="nx">define</span><span class="p">(</span><span class="dl">"</span><span class="s2">app</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">"</span><span class="s2">calculator</span><span class="dl">"</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">calculator</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">calculator</span><span class="p">.</span><span class="nx">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="c1">// =&gt; 3</span>
<span class="p">});</span></code></pre></figure>

<p>The <code class="language-plaintext highlighter-rouge">define</code> method can receive three parameters <code class="language-plaintext highlighter-rouge">define(id?, dependencies?, factory);</code>. The first is optional, it would be the module id, if it’s not present it would be the one that the loader (in this case <code class="language-plaintext highlighter-rouge">RequireJS</code>) is expecting according to his configuration for that given file, for example:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="nx">require</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">baseUrl</span><span class="p">:</span> <span class="dl">'</span><span class="s1">...</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">paths</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">myModule</span><span class="p">:</span> <span class="dl">'</span><span class="s1">myModule-2.0.0.min</span><span class="dl">'</span><span class="p">,</span></code></pre></figure>

<p>The second argument is the <code class="language-plaintext highlighter-rouge">dependencies</code>, an array of the module (ids) required by the module that is being defined. The dependencies must be resolved prior to the execution of the module <code class="language-plaintext highlighter-rouge">factory</code> function, which is the third parameter, and the resolved values will be passed as arguments to this factory function with an order that matches those dependencies.</p>

<h3 id="umd-universal-module-definition">UMD (Universal Module Definition)</h3>

<p><em>For projects that require you to support both AMD and CommonJS features, there’s yet another format: Universal Module Definition (UMD).
UMD essentially creates a way to use either of the two, while also supporting the global variable definition. As a result, UMD modules are capable of working on both client and server.</em></p>

<p>Here there are some patterns to achieve it https://github.com/umdjs/umd</p>

<p>Example:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// calculator.js</span>
  <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">definition</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">module</span> <span class="o">!=</span> <span class="dl">'</span><span class="s1">undefined</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span>
      <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">definition</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">define</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">function</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="p">)</span>
      <span class="nx">define</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">definition</span><span class="p">);</span>
    <span class="k">else</span>
      <span class="nx">context</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">definition</span><span class="p">();</span>
  <span class="p">}(</span><span class="dl">'</span><span class="s1">calculator</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// your module here!</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">sum</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">});</span></code></pre></figure>

<p>This is an example for the <a href="http://rmodal.js.org/">Rmodal library</a>, that supports CommonJS, AMD or globals.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// https://github.com/zewish/rmodal.js/blob/master/src/rmodal.js</span>

  <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">)</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">use strict</span><span class="dl">"</span><span class="p">;</span>
    <span class="c1">// ...</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">define</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">function</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">define</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">RModal</span><span class="p">;</span>
        <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">module</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">RModal</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">RModal</span> <span class="o">=</span> <span class="nx">RModal</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">})(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">);</span>    </code></pre></figure>

<h3 id="es6-modules">ES6 Modules</h3>

<p>With the new ECMAScript edition, we have native support for a new type of modules. An ES6 module is a file containing JS code. That file is automatically in strict mode, and you can use the keywords <code class="language-plaintext highlighter-rouge">import</code> and <code class="language-plaintext highlighter-rouge">export</code> inside it.</p>

<p>In that file everything you declare is local to the module, we use <code class="language-plaintext highlighter-rouge">export</code> to make something public.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// foo.js</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">foo</span><span class="dl">"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Bar</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// you can export it later with a Export List</span>

<span class="kd">function</span> <span class="nx">sayHi</span><span class="p">(){</span>
  <span class="c1">//...</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">sayBye</span><span class="p">(){</span>
  <span class="c1">//...</span>
<span class="p">}</span>

<span class="k">export</span> <span class="p">{</span><span class="nx">sayHi</span><span class="p">,</span> <span class="nx">sayBye</span><span class="p">};</span>


<span class="c1">// otherFile.js</span>

<span class="k">import</span> <span class="p">{</span><span class="nx">sayHi</span><span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">foo.js</span><span class="dl">"</span><span class="p">;</span>
<span class="nx">sayHi</span><span class="p">();</span></code></pre></figure>

<p>You can also rename both your exports and imports</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// foo.js</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">sayHi</span> <span class="k">as</span> <span class="nx">hi</span> <span class="p">};</span>

<span class="c1">// also several at once:</span>

<span class="k">export</span> <span class="p">{</span>
  <span class="nx">sayHi</span>  <span class="k">as</span> <span class="nx">hi</span><span class="p">,</span>
  <span class="nx">sayBye</span> <span class="k">as</span> <span class="nx">bye</span>
<span class="p">};</span>

<span class="c1">// otherFile.js</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">hi</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">foo.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">bye</span> <span class="k">as</span> <span class="nx">byebye</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">foo.js</span><span class="dl">"</span><span class="p">;</span></code></pre></figure>

<p>To play nice with CommonJS and AMD modules, ES6 treats them as if they had a <code class="language-plaintext highlighter-rouge">default</code> export:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">npm</span> <span class="nx">install</span> <span class="nx">lodash</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">each</span><span class="p">,</span> <span class="nx">map</span><span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">lodash</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="k">default</span> <span class="k">as</span> <span class="nx">_</span><span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">lodash</span><span class="dl">"</span><span class="p">;</span>
<span class="c1">// shorthand</span>
<span class="k">import</span> <span class="nx">_</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">lodash</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// This default export is nothing special, you can define your own</span>
<span class="c1">// foo.js</span>

<span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">foo</span><span class="dl">"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">export</span> <span class="p">{</span><span class="nx">foo</span> <span class="k">as</span> <span class="k">default</span><span class="p">};</span>
<span class="c1">// short hand</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">foo</span><span class="p">;</span></code></pre></figure>

<p>Module objects:  you can get the imports as properties from a module namespace object:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// foo.js</span>

<span class="kd">function</span> <span class="nx">sayHi</span><span class="p">(){</span>
  <span class="c1">//...</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">sayBye</span><span class="p">(){</span>
  <span class="c1">//...</span>
<span class="p">}</span>

<span class="k">export</span> <span class="p">{</span><span class="nx">sayHi</span><span class="p">,</span> <span class="nx">sayBye</span><span class="p">};</span>


<span class="c1">// otherFile.js</span>

<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">foo</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">foo.js</span><span class="dl">"</span><span class="p">;</span>
<span class="nx">foo</span><span class="p">.</span><span class="nx">sayHi</span><span class="p">();</span>
<span class="nx">foo</span><span class="p">.</span><span class="nx">sayBye</span><span class="p">();</span>

<span class="c1">// this doesn't seem to exist : /</span>
<span class="c1">// import { sayHi } as foo from "foo.js";</span>

<span class="c1">// There is also a shorthand to import and then re-export:</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">sayHi</span><span class="p">,</span> <span class="nx">sayBye</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">foo.js</span><span class="dl">"</span>
<span class="k">export</span> <span class="o">*</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">yetAnotherFile.js</span><span class="dl">"</span></code></pre></figure>

<p>Some more good notes from * <a href="https://hacks.mozilla.org/2015/08/es6-in-depth-modules">Es6 In-Depth Modules</a>:</p>

<ul>
  <li>
    <p><em>All exported identifiers must be explicitly exported by name in the source code. You can’t programmatically loop through an array and export a bunch of names in a data-driven way.</em></p>
  </li>
  <li>
    <p><em>Module objects are frozen. There is no way to hack a new feature into a module object, polyfill style.</em></p>
  </li>
  <li>
    <p><em>There is no error recovery for import errors. An app may have hundreds of modules in it, and if anything fails to load or link, nothing runs. You can’t import in a try/catch block. (The upside here is that because the system is so static, webpack can detect those errors for you at compile time.)</em></p>
  </li>
</ul>

<p>Links:</p>

<ul>
  <li><a href="https://medium.freecodecamp.com/javascript-modules-a-beginner-s-guide-783f7d7a5fcc">https://medium.freecodecamp.com/javascript-modules-a-beginner-s-guide-783f7d7a5fcc</a></li>
  <li><a href="https://addyosmani.com/resources/essentialjsdesignpatterns/book/#modulepatternjavascript">https://addyosmani.com/resources/essentialjsdesignpatterns/book/#modulepatternjavascript</a></li>
  <li><a href="http://www.leanpanda.com/blog/2015/06/28/amd-requirejs-commonjs-browserify/">http://www.leanpanda.com/blog/2015/06/28/amd-requirejs-commonjs-browserify/</a></li>
  <li><a href="https://medium.freecodecamp.com/javascript-modules-a-beginner-s-guide-783f7d7a5fcc">https://medium.freecodecamp.com/javascript-modules-a-beginner-s-guide-783f7d7a5fcc</a></li>
  <li><a href="https://hacks.mozilla.org/2015/08/es6-in-depth-modules">https://hacks.mozilla.org/2015/08/es6-in-depth-modules</a></li>
</ul>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/03/08/problems-extending-enumerable/" data-toggle="tooltip" data-placement="top" title="Problems extending Enumerable">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/05/05/merge-with-block/" data-toggle="tooltip" data-placement="top" title="Merge with block">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/fsainz">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="http://codepen.io/fsainz">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-codepen fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="https://speakerdeck.com/fsainz/">
                          <span class="fa-stack fa-lg">
                            <svg width="50px" height="50px" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                                <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
                                    <path d="M256,512 C397.384903,512 512,397.384903 512,256 C512,114.615097 397.384903,0 256,0 C114.615097,0 0,114.615097 0,256 C0,397.384903 114.615097,512 256,512 Z M157.00292,151 C136.014487,151 119,168.007298 119,188.999 L119,323.001 C119,343.987268 136.020832,361 157.00292,361 L355.99708,361 C376.985513,361 394,343.992702 394,323.001 L394,188.999 C394,168.012732 376.979168,151 355.99708,151 L157.00292,151 Z M213.327471,218.914007 C201.732729,218.914007 192.333333,228.319857 192.333333,239.90541 L192.333333,272.040251 C192.333333,283.633483 201.743977,293.031654 213.327471,293.031654 L299.672529,293.031654 C311.267271,293.031654 320.666667,283.625804 320.666667,272.040251 L320.666667,239.90541 C320.666667,228.312179 311.256023,218.914007 299.672529,218.914007 L213.327471,218.914007 Z M210.470588,255.972831 L247.529412,237.639497 L247.529412,274.306164 L210.470588,255.972831 Z M264.279134,274.502243 L264.279134,237.443419 L300.945801,255.972831 L264.279134,274.502243 Z" id="sliderdeck" fill="#404040" sketch:type="MSShapeGroup"></path>
                                </g>
                            </svg>
                          </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="http://fsainz.tumblr.com/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-tumblr fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="https://de.linkedin.com/in/fernandosainz">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="mailto:info@fsainz.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">
                  Copyright &copy; fsainz 2026
                  <br />
                  Theme adapted from <a class='text-muted' href="https://github.com/IronSummitMedia/startbootstrap-clean-blog-jekyll">startbootstrap-clean-blog-jekyll</a>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>

<script src="../js/lightgallery-all.min.js"></script>

<script>
  
</script>


</body>

</html>
